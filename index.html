<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>Error 1101</title>

<style>
body,html{margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;background:#fff;color:#000;min-height:100vh;width:100%;overflow-x:hidden}
#fakePage{padding:40px 20px 100px;max-width:800px;margin:0 auto;position:relative;z-index:50}
.error-title{font-size:48px;font-weight:400;color:#404040}
.ray-id-row{font-size:14px;color:#999;margin:15px 0 30px;font-family:monospace}
.status-text{font-size:28px;color:#404040;margin-bottom:40px}
.section-title{font-size:28px;color:#404040;margin:40px 0 15px}
.section-p{font-size:16px;color:#404040;line-height:1.5}
.cf-link{color:#0051c3;cursor:pointer}
.hr{border:0;border-top:1px solid #d9d9d9;margin:40px 0 20px}
.footer-row{font-size:13px;color:#666;line-height:1.8}

#realContent{display:none;position:fixed;inset:0;z-index:100;background:#333;background-size:cover;background-position:center;color:#fff;flex-direction:column;align-items:center;padding-top:15vh;text-align:center}
#realContent::before{content:"";position:absolute;inset:0;background:rgba(0,0,0,.4);z-index:-1}
#snowCanvas{position:fixed;inset:0;z-index:120;pointer-events:none;display:none}

#topControls{display:none;position:fixed;top:20px;right:20px;z-index:2000;gap:20px}
.icon-btn{font-size:26px;cursor:pointer;color:#fff;text-shadow:0 0 5px #000}
@keyframes rotate{from{transform:rotate(0)}to{transform:rotate(360deg)}}
.music-playing{animation:rotate 3s linear infinite}

.main-title{font-size:1.8rem;font-weight:800;background:linear-gradient(90deg,#00f0ff,#a855f7);-webkit-background-clip:text;color:transparent;margin-bottom:40px}
.btn-group{display:flex;flex-direction:column;gap:15px;width:85%;max-width:280px}
.copy-btn{padding:16px;background:linear-gradient(90deg,#00f0ff,#a855f7);border:none;border-radius:15px;font-size:16px;font-weight:bold}
#notice{margin-top:60px;color:#a5f3fc;font-weight:bold}

.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.8);backdrop-filter:blur(8px);align-items:center;justify-content:center;z-index:3000}
.modal-content{background:#fff;padding:30px 20px;border-radius:20px;width:80%;max-width:320px;text-align:center}
input{width:100%;padding:12px;border:1px solid #eee;border-radius:12px;font-size:16px}
.primary-btn{width:100%;padding:14px;background:#0051c3;color:#fff;border:none;border-radius:12px;font-weight:bold;margin-top:10px}
.secondary-btn{background:#666}
</style>
</head>

<body>

<!-- ‚úÖ Èü≥‰πêÊ†áÁ≠æÔºàiOS ÂêàËßÑÔºâ -->
<audio id="bgMusic" loop preload="none" playsinline webkit-playsinline></audio>

<canvas id="snowCanvas"></canvas>

<div id="fakePage">
  <h1 class="error-title">Error 1101</h1>
  <p class="ray-id-row">Ray ID: <span id="ray-id"></span></p>
  <h2 class="status-text">Worker threw exception</h2>
  <p class="section-p">An unknown error occurred while rendering the page.</p>
  <p class="section-p"><span class="cf-link" onclick="openModal('userLoginModal')">Workers - Errors and Exceptions</span></p>
  <hr class="hr">
  <div class="footer-row">Performance & security by Cloudflare</div>
</div>

<div id="topControls">
  <div id="musicBtn" class="icon-btn" onclick="toggleMusic()">üéµ</div>
  <div class="icon-btn" onclick="openAdminPortal()">‚öôÔ∏è</div>
</div>

<div id="realContent">
  <div id="mainTitle" class="main-title"></div>
  <div class="btn-group">
    <button class="copy-btn" onclick="copyLink(1)">Â§çÂà∂ËÆ¢ÈòÖÈìæÊé• 1</button>
    <button class="copy-btn" onclick="copyLink(2)">Â§çÂà∂ËÆ¢ÈòÖÈìæÊé• 2</button>
    <button class="copy-btn" onclick="copyLink(3)">Â§çÂà∂ËÆ¢ÈòÖÈìæÊé• 3</button>
  </div>
  <p id="notice"></p>
</div>

<div id="userLoginModal" class="modal">
  <div class="modal-content">
    <input id="userPwdInput" type="password" placeholder="Code">
    <button class="primary-btn" onclick="doUserLogin()">Verify</button>
  </div>
</div>

<script>
let SETTINGS={}
const audio=document.getElementById('bgMusic')

async function load(){
  try{
    const r=await fetch("/api/get-links?"+Date.now())
    SETTINGS=await r.json()
  }catch(e){}
}
load()

function openModal(id){document.getElementById(id).style.display='flex'}
function closeModal(id){document.getElementById(id).style.display='none'}

function doUserLogin(){
  const input=document.getElementById('userPwdInput')
  if(input.value===SETTINGS.userPassword){

    // ‚úÖ iOS 16 / 17 Ê†∏ÂøÉÔºöÁÇπÂáªÁû¨Èó¥ËÆæÁΩÆÂπ∂Êí≠Êîæ
    if(SETTINGS.musicUrl){
      audio.src=SETTINGS.musicUrl
      audio.play().then(()=>{
        document.getElementById('musicBtn').classList.add('music-playing')
      }).catch(()=>{})
    }

    document.getElementById('fakePage').style.display='none'
    document.getElementById('realContent').style.display='flex'
    document.getElementById('topControls').style.display='flex'
    document.getElementById('mainTitle').innerText=SETTINGS.titleText||''
    document.getElementById('notice').innerText=SETTINGS.notice||''
    document.getElementById('realContent').style.backgroundImage=`url('${SETTINGS.bgUrl||""}')`
    document.getElementById('snowCanvas').style.display='block'
    initSnow()
    closeModal('userLoginModal')
  }else{
    alert("ÊÇ®ÁöÑÂèçÈ¶àÂ∑≤Êî∂Âà∞ÔºåÊàë‰ª¨‰ºöÂ∞ΩÂø´Â§ÑÁêÜ„ÄÇ")
    closeModal('userLoginModal')
  }
}

function toggleMusic(){
  if(audio.paused){
    audio.play()
    document.getElementById('musicBtn').classList.add('music-playing')
  }else{
    audio.pause()
    document.getElementById('musicBtn').classList.remove('music-playing')
  }
}

function copyLink(n){
  const url=n===1?SETTINGS.sub1:n===2?SETTINGS.sub2:SETTINGS.sub3
  if(!url)return alert("Êú™ÈÖçÁΩÆ")
  navigator.clipboard.writeText(url).then(()=>alert("Â§çÂà∂ÊàêÂäü"))
}

function initSnow(){
  const c=document.getElementById('snowCanvas'),x=c.getContext('2d')
  c.width=innerWidth;c.height=innerHeight
  let f=Array.from({length:100},()=>({x:Math.random()*c.width,y:Math.random()*c.height,r:Math.random()*3+1}))
  function d(){
    x.clearRect(0,0,c.width,c.height)
    x.fillStyle="white"
    f.forEach(s=>{x.beginPath();x.arc(s.x,s.y,s.r,0,Math.PI*2);x.fill();s.y+=1;if(s.y>c.height)s.y=0})
    requestAnimationFrame(d)
  }
  d()
}

document.getElementById('ray-id').innerText=Math.random().toString(16).slice(2,14)
</script>

</body>
</html>